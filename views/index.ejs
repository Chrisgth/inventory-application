<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title><%= title %></title>
</head>
<body>
	<%- include('./partials/nav.ejs') %>
	<div>
		<div class="list">
			<h2>Items</h2>
			<div class="items">
				<% if(items) { %>
					<% items.map((item) => { %>
						<div class="single">
							<h2><%= item.itemName %></h2>
							<a class="delete" data-doc="<%= item._id %>">Delete</a>
							<a class="edit" href="/edit/<%= item._id %>">Edit</a>
						</div>
					<% }) %> 
				<% } %>
			</div>
		</div>
		<div class="categories">
			<p>Sort By:</p>
		</div>
	</div>

	<script defer>
		const trash = Array.from(document.querySelectorAll('.delete'))
		const nodes = Array.from(document.querySelectorAll('.single'))
		trash.forEach((item) => {
			item.addEventListener('click', (e) => {
				const endpoint = `/${item.dataset.doc}`
				fetch(endpoint, {
					method: 'DELETE',
				})
				.then((response) => {
					nodes[trash.indexOf(item)].remove()
				})
				.catch(err => console.log(err))
		})})
	</script>
</body>
</html>